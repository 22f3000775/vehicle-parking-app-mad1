<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Admin - Parking Lots</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
  <style>
    body {
      background-color: #f5f8ff;
      color: #223456;
      min-height: 100vh;
      font-family: 'Courier New', Courier, monospace;
    }

    /* Navbar styled like user dashboard */
    .navbar {
      width: 100%;
      background: #223456;
      color: white;
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 18px 40px;
      box-sizing: border-box;
      font-weight: bold;
      letter-spacing: 1.5px;
      font-size: 1.25rem;
    }

    .navbar a.btn-outline {
      border-color: #9bc1ff;
      color: #9bc1ff;
      font-weight: normal;
      font-size: 1rem;
      text-transform: uppercase;
      padding: 8px 20px;
      border-radius: 20px;
      transition: background-color 0.2s;
    }

    .navbar a.btn-outline:hover {
      background-color: #9bc1ff;
      color: #223456;
      text-decoration: none;
    }

    .btn-primary {
      background-color: #497ec5;
      border-color: #497ec5;
      font-weight: normal;
      font-size: 1rem;
      padding: 8px 20px;
      border-radius: 20px;
      text-transform: uppercase;
      transition: background-color 0.2s;
    }

    .btn-primary:hover {
      background-color: #2e4976;
      border-color: #2e4976;
      text-decoration: none;
    }

    /* Container spacing */
    .container {
      padding-top: 40px;
      padding-bottom: 40px;
    }

    /* Card styling same dark blue background, white text */
    .card {
      background-color: #223456;
      color: white;
      border-radius: 14px;
      box-shadow: 3px 6px 0 #cbd3e0;
      height: 100%;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      padding: 20px 30px;
    }

    .card-title {
      color: #9bc1ff;
      font-weight: bold;
      font-size: 1.3rem;
      margin-bottom: 1rem;
      text-transform: uppercase;
      letter-spacing: 1.5px;
    }

    .card-text {
      font-size: 1.1rem;
      margin-bottom: 0.5rem;
    }

    /* Buttons container at bottom right */
    .card-buttons {
      margin-top: 1.3rem;
      display: flex;
      justify-content: flex-end;
      gap: 12px;
    }

    /* Edit button - blue background white text */
    .btn-edit {
      background-color: #497ec5;
      color: white;
      font-weight: bold;
      padding: 8px 20px;
      border-radius: 20px;
      border: none;
      text-transform: uppercase;
      letter-spacing: 1.3px;
      cursor: pointer;
      transition: background-color 0.2s;
    }

    .btn-edit:hover {
      background-color: #2e4976;
      color: white;
    }

    /* Delete button - white background with dark text */
    .btn-delete {
      background-color: white;
      color: #223456;
      font-weight: bold;
      padding: 8px 20px;
      border-radius: 20px;
      border: none;
      text-transform: uppercase;
      letter-spacing: 1.3px;
      cursor: pointer;
      transition: background-color 0.2s, color 0.2s;
    }

    .btn-delete:hover {
      background-color: #cbd3e0;
      color: #223456;
    }

    /* Modal styling like user dashboard with dark blue bg */
    .modal-content {
      background-color: #223456;
      color: white;
      border-radius: 20px;
      padding: 20px 30px;
      box-shadow: 5px 12px 28px 4px #aac5f644;
    }

    /* Modal header */
    .modal-title {
      font-weight: bold;
      font-size: 1.5rem;
      margin-bottom: 15px;
      letter-spacing: 1.3px;
      color: #9bc1ff;
      text-transform: uppercase;
    }

    /* Form labels */
    .form-label {
      color: #9bc1ff;
      font-weight: bold;
    }

    /* Form control */
    .form-control {
      border-radius: 12px;
      border: 1.5px solid #497ec5;
      padding: 10px 16px;
      background-color: #f5faff;
      color: #223456;
      font-weight: bold;
      font-size: 1rem;
      transition: border-color 0.2s;
    }

    .form-control:focus {
      border-color: #2e4976;
      outline: none;
      box-shadow: 0 0 8px #2e4976aa;
      background-color: white;
      color: #223456;
    }

    /* Modal footer buttons */
    .modal-footer button {
      border-radius: 20px;
      font-weight: bold;
      padding: 8px 20px;
      letter-spacing: 1.3px;
      text-transform: uppercase;
    }

    /* Cancel button style like outline */
    .btn-outline-light {
      background-color: transparent;
      border: 2px solid white;
      color: white;
      transition: background-color 0.2s, color 0.2s;
    }

    .btn-outline-light:hover {
      background-color: white;
      color: #223456;
      text-decoration: none;
    }

    /* Save/Create btn style like primary */
    .btn-primary {
      background-color: #497ec5;
      border-color: #497ec5;
      color: white;
      transition: background-color 0.2s;
    }

    .btn-primary:hover {
      background-color: #2e4976;
      border-color: #2e4976;
      color: white;
      text-decoration: none;
    }

    /* Responsive adjustments */
    @media (max-width: 768px) {
      .container {
        padding-left: 20px;
        padding-right: 20px;
      }
    }

  </style>
</head>

<body>

  <!-- Navbar -->
  <div class="navbar">
    <div>Parking Lots</div>
    <div>
      <a href="{{ url_for('routes_bp.admin_dashboard') }}" class="btn btn-outline">Back to Dashboard</a>
      <button class="btn btn-primary ms-3" data-bs-toggle="modal" data-bs-target="#createLotModal">Create New Lot</button>
    </div>
  </div>

  <div class="container mt-4">
    <!-- Lots Cards -->
    {% if lot_data %}
      <div class="row gy-4">
        {% for lot in lot_data %}
        <div class="col-md-6 col-lg-4">
          <div class="card">
            <div>
              <h5 class="card-title">{{ lot.name }}</h5>
              <p class="card-text mb-1">Total Spots: <strong>{{ lot.total_spots }}</strong></p>
              <p class="card-text mb-1">Occupied Spots: <strong>{{ lot.occupied_spots }}</strong></p>
              <p class="card-text mb-0">Address: <small>{{ lot.address }}</small></p>
            </div>
            <div class="card-buttons">
              <button class="btn-edit btn-sm" data-bs-toggle="modal" data-bs-target="#editLotModal{{ lot.id }}">Edit Spots</button>
              <button class="btn-delete btn-sm" data-bs-toggle="modal" data-bs-target="#deleteLotModal{{ lot.id }}">Delete</button>
            </div>
          </div>
        </div>

        <!-- Edit Modal for this lot -->
        <div class="modal fade" id="editLotModal{{ lot.id }}" tabindex="-1" aria-labelledby="editLotModalLabel{{ lot.id }}" aria-hidden="true">
          <div class="modal-dialog">
            <div class="modal-content">
              <form method="POST" action="{{ url_for('routes_bp.edit_lot', lot_id=lot.id) }}">
                <div class="modal-header">
                  <h5 class="modal-title" id="editLotModalLabel{{ lot.id }}">Edit Number of Spots - {{ lot.name }}</h5>
                  <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                  <div class="mb-3">
                    <label for="no_of_spots_{{ lot.id }}" class="form-label">Number of Spots</label>
                    <input type="number" class="form-control" id="no_of_spots_{{ lot.id }}" name="no_of_spots" min="1" value="{{ lot.total_spots }}" required />
                  </div>
                </div>
                <div class="modal-footer">
                  <button type="button" class="btn btn-outline-light" data-bs-dismiss="modal">Cancel</button>
                  <button type="submit" class="btn btn-primary">Save Changes</button>
                </div>
              </form>
            </div>
          </div>
        </div>

        <!-- Delete Confirmation Modal for this lot -->
        <div class="modal fade" id="deleteLotModal{{ lot.id }}" tabindex="-1" aria-labelledby="deleteLotModalLabel{{ lot.id }}" aria-hidden="true">
          <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
              <form method="POST" action="{{ url_for('routes_bp.delete_lot', lot_id=lot.id) }}">
                <div class="modal-header">
                  <h5 class="modal-title" id="deleteLotModalLabel{{ lot.id }}">Confirm Delete</h5>
                  <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                  Are you sure you want to delete the parking lot:<br />
                  <strong>{{ lot.name }}</strong>?<br />
                  This action cannot be undone.
                </div>
                <div class="modal-footer">
                  <button type="button" class="btn btn-outline-light" data-bs-dismiss="modal">Cancel</button>
                  <button type="submit" class="btn btn-primary">Delete</button>
                </div>
              </form>
            </div>
          </div>
        </div>

        {% endfor %}
      </div>
    {% else %}
      <div class="alert alert-info text-center" role="alert">
        No parking lots found.
      </div>
    {% endif %}
  </div>

  <!-- Create New Lot Modal -->
  <div class="modal fade" id="createLotModal" tabindex="-1" aria-labelledby="createLotModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <form method="POST" action="{{ url_for('routes_bp.create_lot') }}">
          <div class="modal-header">
            <h5 class="modal-title" id="createLotModalLabel">Create New Lot</h5>
            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <div class="mb-3">
              <label for="location" class="form-label">Location</label>
              <input type="text" class="form-control" id="location" name="location" required />
            </div>
            <div class="mb-3">
              <label for="address" class="form-label">Address</label>
              <input type="text" class="form-control" id="address" name="address" required />
            </div>
            <div class="mb-3">
              <label for="price" class="form-label">Price</label>
              <input type="number" class="form-control" id="price" name="price" step="0.01" min="0" required />
            </div>
            <div class="mb-3">
              <label for="no_of_spots" class="form-label">Number of Spots</label>
              <input type="number" class="form-control" id="no_of_spots" name="no_of_spots" min="1" required />
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-outline-light" data-bs-dismiss="modal">Cancel</button>
            <button type="submit" class="btn btn-primary">Create</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>
